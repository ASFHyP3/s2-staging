import boto3


queue_url = 'https://sqs.us-west-2.amazonaws.com/123456789012/s2-staging-Queue-MxuL1mLZVvUO'
sqs = boto3.client('sqs')


def divide_chunks(l, n):
    for i in range(0, len(l), n):
        yield l[i:i + n]


scenes = [
    'S2B_MSIL1C_20240506T162829_N0510_R083_T21XWD_20240506T183544',
    'S2B_MSIL1C_20240508T084559_N0510_R107_T41XNE_20240508T091111',
    'S2B_MSIL1C_20240508T170849_N0510_R112_T23XNK_20240508T191349',
    'S2B_MSIL1C_20240510T042709_N0510_R133_T46RCS_20240510T062123',
    'S2B_MSIL1C_20240510T174909_N0510_R141_T20XMN_20240510T205948',
    'S2B_MSIL1C_20240512T150759_N0510_R025_T23XMA_20240512T184926',
    'S2B_MSIL1C_20240518T152809_N0510_R111_T24XWM_20240518T175119',
    'S2B_MSIL1C_20240520T042659_N0510_R133_T46REV_20240520T062244',
    'S2B_MSIL1C_20240524T054639_N0510_R048_T43TEH_20240524T073730',
    'S2B_MSIL1C_20240527T173859_N0510_R098_T21XVJ_20240527T211733',
]

for batch in divide_chunks(scenes, 10):
    entries = [{'Id': scene, 'MessageBody': scene} for scene in batch]
    sqs.send_message_batch(QueueUrl=queue_url, Entries=entries)
